<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Processing Video</title>
        <style>
            .loading-container {
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                min-height: 100vh;
                font-family: Arial, sans-serif;
                background-color: #f5f5f5;
            }

            .spinner {
                width: 50px;
                height: 50px;
                border: 5px solid #f3f3f3;
                border-top: 5px solid #3498db;
                border-radius: 50%;
                animation: spin 1s linear infinite;
                margin-bottom: 20px;
            }

            .loading-text {
                font-size: 1.2rem;
                color: #333;
            }

            @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }
        </style>
    </head>
    <body>
        <div class="loading-container">
            <div class="spinner"></div>
            <div class="loading-text">Processing your video...</div>
        </div>

        <script>
           function checkStatus() {
                fetch(`/status/${filename}`)
                    .then(response => response.json())
                    .then(data => {
                        if (data.status === 'complete') {
                            window.location.href = `/results?filename=${filename}`;
                        } else if (data.status === 'error') {
                            document.getElementById('error-message').style.display = 'block';
                            document.getElementById('error-message').textContent = 
                                'Error processing video: ' + data.error;
                            document.querySelector('.loading-spinner').style.display = 'none';
                        } else if (data.status === 'processing') {
                            setTimeout(checkStatus, 2000);
                        }
                    })
                    .catch(error => {
                        document.getElementById('error-message').style.display = 'block';
                        document.getElementById('error-message').textContent = 
                            'Error checking status: ' + error;
                        document.querySelector('.loading-spinner').style.display = 'none';
                    });
            }

            document.addEventListener('DOMContentLoaded', checkStatus);
        </script>
    </body>
</html>